<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="icon" href="/icons/fav.png" />
  <meta name="description" content="Learn Arabic dialects (Egyptian, Levantine, Moroccan Darija, Modern Standard Arabic) through interactive lessons, stories, vocabulary practice, and AI-powered conversation tutoring.">
  <meta name="keywords" content="Arabic, Egyptian Arabic, Levantine Arabic, Moroccan Darija, Modern Standard Arabic, Learn Arabic, Arabic lessons, Arabic stories, Arabic vocabulary, Arabic tutor, Arabic dialects">
  <meta name="author" content="Sherif Elmetwally">

  <!-- Preconnect to critical third-party origins (must be early in head) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="preconnect" href="https://cdn.skypack.dev">
  <link rel="dns-prefetch" href="https://bundle.run">

  <!-- Preload critical fonts for faster FCP/LCP -->
  <link rel="preload" href="/fonts/ReadexPro-Regular.ttf" as="font" type="font/truetype" crossorigin>
  <link rel="preload" href="/fonts/ReadexPro-SemiBold.ttf" as="font" type="font/truetype" crossorigin>

  <!-- Preload LCP image for faster largest contentful paint -->
  <link rel="preload" href="/images/banner.png" as="image" fetchpriority="high">

  <!-- Load Google Font with lower priority (non-blocking) -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Rakkas&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Rakkas&display=swap"></noscript>

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- PWA meta tags -->
  <meta name="theme-color" content="#365463" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Parallel Arabic" />
  <link rel="apple-touch-icon" href="/icons/icon.png" />

  <!-- Manifest link will be injected by the plugin via +layout.svelte -->
  %sveltekit.head%
</head>

<body data-sveltekit-preload-data="hover">
  <div style="display: contents">%sveltekit.body%</div>

  <!-- Non-critical scripts loaded after page content -->
  <script>
    // Defer loading of non-critical CDN scripts until after page load
    window.addEventListener('load', function() {
      // Skip in Capacitor native app
      if (window.Capacitor ? .isNativePlatform ? .()) return;

      // Use requestIdleCallback for lowest priority, with timeout fallback
      var loadScripts = function() {
        // Arabic virtual keyboard
        var s1 = document.createElement('script');
        s1.type = 'module';
        s1.src = 'https://cdn.jsdelivr.net/npm/arabic-virtual-keyboard@0.2.8/+esm';
        document.head.appendChild(s1);

        // Pixelmatch
        var s2 = document.createElement('script');
        s2.src = 'https://bundle.run/pixelmatch@5.2.1';
        s2.async = true;
        document.head.appendChild(s2);

        // Lottie
        var s3 = document.createElement('script');
        s3.src = 'https://cdn.skypack.dev/lottie-web';
        s3.async = true;
        document.head.appendChild(s3);

        // Site behaviour (analytics)
        var s4 = document.createElement('script');
        s4.defer = true;
        s4.id = 'site-behaviour-script';
        s4.dataset.secret = 'e25ce093-4111-4e8b-9dc0-f6b715e69c3a';
        s4.src = 'https://sitebehaviour-cdn.fra1.cdn.digitaloceanspaces.com/index.min.js';
        document.head.appendChild(s4);

        // Datafast analytics (moved from head for better LCP)
        var s5 = document.createElement('script');
        s5.defer = true;
        s5.dataset.websiteId = 'dfid_llUL02gpewcvzR8hGDuhO';
        s5.dataset.domain = 'www.parallel-arabic.com';
        s5.src = 'https://datafa.st/js/script.js';
        document.head.appendChild(s5);
      };

      if ('requestIdleCallback' in window) {
        requestIdleCallback(loadScripts, {
          timeout: 2000
        });
      } else {
        setTimeout(loadScripts, 100);
      }
    });
  </script>
</body>

</html>